<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>EcoliSimulator: INTRODUCTION</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LOGO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EcoliSimulator
   &#160;<span id="projectnumber">2.0.1a</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">INTRODUCTION </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>The program <code>EcoliSimulator</code> is a command-line based simulator of different models for Ecoli, which produce graphical, numerical and <code>Statistical</code> analysis of the result obtained.<br />
 The program is completely written in c++: and use <b>gnuplot</b> and/or <b>Matlab</b> as a graphical toolbox.<br />
 The different models are implemented to give the maximal freedom to the user to modify parameters and and try to analyze the output.<br />
 It is design to be usable in a step-by-step (the duration of the simulations are estimated) or a pre-set mode and produces a Latex file where all the informations about the simulations and output are collected in a systematic, an hopefully, coherent and readable version.<br />
 It is possible to use more then one thread in order to perform the simulations in parallel.</p>
<h1><a class="anchor" id="req_sec"></a>
Requirements and Installation</h1>
<h2><a class="anchor" id="req"></a>
Requirements</h2>
<p>In order to run all the functionalities of the program one needs that on the computer are installed</p>
<ul>
<li><b>Required Programs:</b><ul>
<li><b>gnuplot</b> - <code>is a portable command-line driven graphing utility for Linux, OS/2, MS Windows, OSX, VMS, and many other platforms. The source code is copyrighted but freely distributed</code> it is important that the option of <code>set terminal pngcairo</code> and or <code>set terminal gif</code> is available: If you don't have the gif terminal, it is necessary to have the program <code>apngasm</code> (see below) to produce the film of the evolution of the density distribution or the single bacterium tracking.</li>
<li><b>.gif or .png format reader</b> any program able to open .png files with multiple layers. In order to see while the program is running the video it is recommended to have installed <b>Mozilla Firefox</b> - (known simply as Firefox) is a free and open-source web browser.</li>
<li><b>program for LateX formats</b> In order to read and visualize the report it is necessary to have installed a program which read LateX language.</li>
</ul>
</li>
<li><b>Optional Programs:</b><ul>
<li><b>apngasm</b> - Creates highly optimized Animated PNG files from PNG/TGA image sequences.</li>
<li><b>Matlab</b> - Commercial Software produced by The MathWorks base on a high-level language and interactive environment. <br />
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="Inst"></a>
Installation</h2>
<p>To instal the program you can use the Makefile or cmake (or "by hand") NOTE: In order to install automatically the External programs it is raccomanded to have installed</p>
<ul>
<li>GNU make (<a href="https://www.gnu.org/software/make/">https://www.gnu.org/software/make/</a>)</li>
<li>curl (<a href="https://curl.haxx.se/">https://curl.haxx.se/</a>)</li>
<li>cmake (<a href="https://cmake.org/">https://cmake.org/</a>)</li>
<li>a program to decompress .zip files. For example, for unix unzip, for windows 7zip (<a href="http://www.7-zip.org/">http://www.7-zip.org/</a>)</li>
<li>c++ compiler (g++) with support for c++11</li>
</ul>
<p>If you are using different programs to achive these tasks, you can modify the definitions in the Makefile.</p>
<ul>
<li><p class="startli">open a terminal and navigate to the folder EcoliSimulator_0.0.1a, which contains src/ and /include.</p>
<p class="startli">-<b>Makefile</b>: You have many options according to what you want install. Notice that the Makefile does not check if a program is already installed. </p><pre class="fragment">- Install only EcoliSimulator:
    type make
        &gt;:EcoliSimulator stefanobelloni$ make
    to process the Makefile
    it might happend that you need to type make.exe or the complete path to "make" or 
    mingw32-make.exe according to your needs.
    NOTE: If you use the Makefile and the compiler g++ is not in the PATH variable,
    redefine the variable CC accordingly, for example if the compiler you want to use is g++ and
    it is inside the folder C:\Dev-cpp\Ming64\bin\g++.exe, substitute the definition of the variable CC as follows:
        CC = C:\Dev-cpp\Ming64\bin\g++.exe

- Install gnuplot
    type make gnuplot
        &gt;:EcoliSimulator stefanobelloni$ make gnuplot
    For windows and Os X the installation of gnuplot will not be invasive, in the sense that
- in Windows gnuplot is installed inside the bin folder of EcoliSimulator
- in Os X, when you drag gnuplot in the Application folder the path to the program will be
    /Applications/Gnuplot.app/Contents/Resources/bin/
    NOTE: this version on gnuplot does not have the terminal .gif.
    You need apngasm and tell the program to use it with the option --apngasm

- Install apngasm (binary)
    type make apngasm
        &gt;:EcoliSimulator stefanobelloni$ make apngasm

- Intsall apngasm from source (you need cmake) This will create the executible in the bin folder.
        &gt;:EcoliSimulator stefanobelloni$ make apngasm_src

- To install along with EcoliSimulator also gnuplot and apngasm.
        &gt;:EcoliSimulator stefanobelloni$ make install

- To show the different options to build the program.
        &gt;:EcoliSimulator stefanobelloni$ make help
</pre><p class="startli">-<b>cmake</b>: This will only build EcoliSimulator in the bin folder. </p><pre class="fragment">- create a folder (i.e. build),
        &gt;:build stefanobelloni$ mkdir build
- move inside it
        &gt;:build stefanobelloni$ cin build;
- type:
        &gt;:build stefanobelloni$ cmake ..
- then type
        &gt;:build stefanobelloni$ make
- you can use the options of cmake to customize the installation path.
</pre><p class="startli">-<b>compile by hand:</b> </p><pre class="fragment">- create a folder (for example be it bin)
        &gt;:build stefanobelloni$ mkdir bin
- go inside it
        &gt;:build stefanobelloni$ cin bin
- type
        g++ -std=c++11 -I../include -Wall -o EcoliSimulator ../src/*.cpp ../src/* /*.cpp
    (instead of g++, use the compiler you prefer ...)
</pre></li>
</ul>
<p>By default the Makefile and the cmake will create a bin folder, where the executable can be found and a build folder where the .o objects are saved.</p>
<h1><a class="anchor" id="run_sec"></a>
Running the Program</h1>
<h2><a class="anchor" id="Lunch"></a>
the Program</h2>
<p>The program can be lunch trough the terminal/DOS giving additional parameters to the program, in the following way:</p>
<p>-<b>Available options</b>: </p><pre class="fragment">--matlab=x  .............................  set version matlab 'x'
--gnuplot=y .............................  set path to gnuplot 'y'
--file ..................................  read the file 'EcoliRisposte.Ecoli' to perform the simulations
--file=pathtofile .......................  read file given by pathtofile.
                                          (if the file is where the executable is run, type only the name)
--clear .................................  clear all possible trash data
--qclear ..................................  clear all possible trash data and exit
--reset ..................................  rest cleaning all files and settings
--script .................................  there's no initial page, useful if you run a script
--j=n   ..................................  max number of cores to use: default is half of the available cores
--nocolors ............................... it uses the default colors of the terminal.
                                           use it, if you have some strange colors for the terminal, you might not be
                                           able to read everything ... (not strange is white or black)
--apngasm=x .............................. x is the path to apngasm (with / or \\) if apngasm is in the current
                                         directory type:
                                         --apngasm=./ for Unix , just --apngasm= on Windows
                                         if x is set to no, then the video is not create with apngasm ('.png' file),
                                         but as a '.gif' file.
                                         --apngams tells to create multilayer '.png' file.
                                         NOTE: The defoult (for the first lunch) is '.gif' file.
--clclog ................................. clear the file Ecoli.LogEcoli.
</pre><h1><a class="anchor" id="rout_sec"></a>
Routines</h1>
<h2><a class="anchor" id=""></a>
</h2>
<p>The program allows 3 different mode of use:</p>
<ul>
<li><code>Demo Version</code>: can be used as a validating routine.</li>
<li><code>Programmable Version</code>: The user can program the sequence of the simulations to be performed as well as the parameters and options, for example "the creation of a LateX/pdf Document as summary of the simulations performed". The data are displayed via <code>gnuplot</code>. You can also read the parameters and MODE of simulation from a file. You can create yourself a file, or give the parameters to create a file.</li>
<li><code>Step-by-Step Version</code>: in this Version the user decide step by step the options and Simulations and can visualize the results at the end of every simulating step. In this Mode it is possible to use Matlab to analyze the data.</li>
<li><code>Settings - 121</code> In this version it is possible to test if the program gnuplot, Matlab, apngasm, (LateX interpreter) are correctly installed and change the path where the program looks for these programs.</li>
</ul>
<h1><a class="anchor" id="stat_sec"></a>
Statistical Analysis and Simulations</h1>
<p>It is possible to choose between three different options:</p>
<ul>
<li><b>Simulation</b>: to perform the simulation of the available models and produce a general analysis (see below)</li>
<li><b>Fit parameter model(s)</b>: to fit the parameters of the models(s) from the given data</li>
<li><b>Simulation and Statistical Analysis</b>: to perform first the simulation of the chosen models and afterwords analysis them to fit the parameters, without <code>a priori</code> knowing the model simulated.</li>
</ul>
<h2><a class="anchor" id="tip_sim"></a>
Type of Simulations</h2>
<p>It is possible, afterwords decide which type of simulation the User want to perform. There are 2 alternatives:</p>
<ul>
<li><b>Simulation independent population</b>: produce the simulation of a single or a population of bacteria swimming in a solution of Ligand concentration, where the concentration evolves according to a function (that the user chooses) without being influence by the population of bacteria.</li>
<li><b>Simulation of a population interacting with the ligand</b>: produce the simulation of a single or a population of bacteria swimming in a solution of Ligand concentration. The evolution of the Ligand concentration follows a Diffusion function with sink and source influenced by the bacteria population.</li>
</ul>
<h2><a class="anchor" id="mod_sec"></a>
Models Available</h2>
<p>For the options <code>Simulation independent population</code> and <code>Simulation of a population interacting with the ligand</code> it is possible to choose among 9 different models for the dynamic of the bacteria.</p>
<ul>
<li>[a] <code>Celani Vergassola Memory Kernel</code> <b>CM10</b>;</li>
<li>[b] <code>Molecular level Implementation</code>: Implementation of the signaling pathway in <b>CSV11</b>.</li>
<li>[c] <code>Othmer et al. Model</code> ;</li>
</ul>
<p>For every model it is possible to chose between three different forms of the run distribution, i.e. exponential, inverse-gaussian or exponential-inverse gaussian. You have the possibility to select and modify a great variety of parameters.</p>
<h2><a class="anchor" id="clas_sec"></a>
Ecoli Classes</h2>
<p>The program model the different Models in classes, that are hierarchically organized. The base class is <b><a class="el" href="class_e__coli.html" title="Base Class for a bacterium: It implements the virtual function to evolve the dynamic of the bacterium...">E_coli</a></b>, which defines the common variables and implements (as <b>virtual</b> when needed) the basic functions to produce the simulation of the movement of an Ecoli (see { figure EcoliClass}}.<br />
 The program is versatile and easy adaptable to include new models: it is only needed to implement the interface of E. coli concerning internal dynamic and visualization (9 functions).<br />
 The names of the derived classes have the following feature:</p><ul>
<li>name_rNameDistribution_tNameDistribution where name is the <code>identification name</code>, <code>rNameDistribution</code> means that the <code>run</code> distribution follows, in the stationary case the Distribution <code>DistributionName</code>. Similar for <code>t</code> where is meant the distribution of the tumble, for example <b>r_IG</b> means the <code>run</code> distribution in the steady state follows a Inverse gaussian distribution.</li>
<li><b>Exp</b>: Exponential distribution</li>
<li><b>IG</b>: Inverse Gaussian Distribution</li>
<li><b>ExpIG</b>: Compound Exponential-Inverse Gaussian Distribution</li>
</ul>
<h2><a class="anchor" id="sub_cv"></a>
CV_rExp_tExp Class</h2>
<p>The fist Model is taken from <b>CM10</b>, whose identification name is <b><a class="el" href="class_c_v__r_exp__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium: ">CV_rExp_tExp</a></b>. The main feature is the Variable <img class="formulaInl" alt="$Q(t)$" src="form_33.png"/> which take into account the memory of the bacterium to build the <code>rate function</code> of the jump process associated to the <code>runs</code>. The barrier for the <code>runs</code> is a random variable exponentially distributed{with mean equal to 1}.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \frac{d}{dt}m_{k}=-\nu\cdot m_{k} + \delta^{k}_{0} c + (1-\delta^{k}_{0})k\cdot m_{k-1}, \end{equation}" src="form_0.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \mathcal{Q}(t)=\sum_{k=1}^{k_{N}}\beta_{k}\nu^{k+1}m_{k}(t) \end{equation}" src="form_1.png"/>
</p>
<h2><a class="anchor" id="sub_cv1"></a>
CV_rExpIG_tExp Class</h2>
<p>This class extend the class <b><a class="el" href="class_c_v__r_exp__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium: ">CV_rExp_tExp</a></b> (<b><a class="el" href="class_c_v__r_exp_i_g__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium ExpIG run dustribution CLASS implementig the mod...">CV_rExpIG_tExp</a> : public <a class="el" href="class_c_v__r_exp__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium: ">CV_rExp_tExp</a></b>), and the main feature is characterized by the fact that the evolution of the <code>rate function</code>, which depends also on <img class="formulaInl" alt="$Q(t)$" src="form_33.png"/>, is not a deterministic process, but a <code>Diffusion process</code>{Solution of a SDE}, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ d\Lambda(t)=\lambda(Q(t))dt+\sigma(Q(t))dW(t) \]" src="form_34.png"/>
</p>
<p>and the barrier for the <code>runs</code> is a RV exponentially distributed.</p>
<h2><a class="anchor" id="sub_cv2"></a>
CV_rIG_tExp Class</h2>
<p>This class extend the class <b><a class="el" href="class_c_v__r_exp__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium: ">CV_rExp_tExp</a></b> (<b><a class="el" href="class_c_v__r_i_g__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium IG run Distribution CLASS implementig the model ...">CV_rIG_tExp</a> : public <a class="el" href="class_c_v__r_exp__t_exp.html" title="Celani Vergassola Kernel Model Class for a bacterium: ">CV_rExp_tExp</a></b>), and the main feature is characterized by the fact that the evolution of the <code>rate function</code>, which depends also on <img class="formulaInl" alt="$Q(t)$" src="form_33.png"/>, is not a deterministic process, but a <code>Diffusion process</code>{Solution of a SDE}, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ d\Lambda(t)=\lambda(Q(t))dt+\sigma(Q(t))dW(t) \]" src="form_34.png"/>
</p>
<p>and the barrier for the <code>runs</code> is a deterministic value</p>
<h2><a class="anchor" id="Molecular_rx_ty"></a>
Molecular_rx_ty</h2>
<p>This model is taken from <b>CSV11</b>, and implement the <code>mean field</code> approximation for the molecular-base model of the internal dynamic of the bacterium. The generalization to the Inverse gaussian and exponential-inverse gaussian is straightforward.</p>
<p>The chemotactic transduction pathway is conveniently modeled by the following set of mean-field equations: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align} a&amp;=G(m,L),\\ \frac{d}{dt}m&amp;=F(a,m),\\ \frac{d}{dt}y&amp;=k_a a(1-y)-k_zy,\\ \frac{d}{dt}p_r&amp;=\frac{1-\frac{p_r}{h(y)}}{\tau_t}. \end{align}" src="form_15.png"/>
</p>
<p>The detailed expressions for the functions that appear above are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} G(m,L)&amp;=\frac{1}{1+e^{f(m,L)}},\\ f(m,L)&amp;=n_a\alpha_m(m_0-m)+n_a\ln\frac{1+\frac{L}{K_{off}}}{1+\frac{L}{K_{on}}},\\ F(a,m)&amp;=k_r[\textrm{CheR}](1-a)\frac{M-a}{M-m+K_R}-k_b[\textrm{CheB}]a\frac{m}{m+K_B};\\ h(y)&amp;=\frac{1}{1+\Big(\frac{y}{y_0}\Big)^H}. \end{align*}" src="form_16.png"/>
</p>
<h2><a class="anchor" id="EO_rx_ty"></a>
EO_rx_ty</h2>
<p>This model is taken from <b>OthmerErban</b>: the function for the internal dynamics are those reported in OthmerCartoon} in { Chapter Semplificato}}. The generalization to the Inverse gaussian and exponential-inverse gaussian is performed straightforward.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \begin{aligned} \frac{d}{dt}y_{1}(t)&amp;=\frac{G(c(t,x))-(y_{1}+y_{2})}{\tau_{a}}\\ \frac{d}{dt}y_{2}(t)&amp;=\frac{G(c(t,x))-y_{2}}{\tau_{e}} \end{aligned} \end{equation}" src="form_14.png"/>
</p>
<h1><a class="anchor" id="sec_LIg"></a>
Ligand evolution</h1>
<p>In case the program mode selected is <code>population interacting with the ligand</code> the Ligand concentration follows the following equation:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial}{\partial t}c(t,x,y)=D_c\Delta_{(x,y)}c(t,x,y)-K_c c(t,x,y)+K_p\sum_{i=1}^{n_c}\delta_{(t,x,y)}(p^i_b(t,x,y)) \]" src="form_19.png"/>
</p>
<p>where <img class="formulaInl" alt="$p^i_b$" src="form_20.png"/> is the position of the bacterium number <img class="formulaInl" alt="$i$" src="form_21.png"/>.</p>
<p>The simulation is performed using an ADI method where the boundary conditions are of Neumann's type. The method is as follows: Let <img class="formulaInl" alt="$U=(q_{i,j})_{i=1...n_x,j=1...n_y}$" src="form_22.png"/> be the matrix of the mesh for the rectangular domain and <img class="formulaInl" alt="$Q$" src="form_23.png"/> the matrix of the source. Let <img class="formulaInl" alt="$L_x^{n_x}$" src="form_24.png"/> be the Laplacian-matrix is the <img class="formulaInl" alt="$x$" src="form_25.png"/> direction, it is a <img class="formulaInl" alt="$n_x\times n_x$" src="form_26.png"/> matrix (similar for <img class="formulaInl" alt="$y$" src="form_27.png"/>), then using the Thompson's Algorithm for the resulting tridiagonal system we solve the PDE in two steps:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ L^{n_x}_x\otimes U = (U\otimes L^{n_y}_y)^T +\frac{dt\cdot Q}{2} \]" src="form_28.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ L^{n_y}_y\otimes U^T = (U^T\otimes L^{n_x}_x)^T+\frac{dt\cdot Q^T}{2} \]" src="form_29.png"/>
</p>
<p>where with <img class="formulaInl" alt="$\otimes$" src="form_30.png"/> we indicate the <code>matrix</code> product, and with <img class="formulaInl" alt="$Q^T$" src="form_31.png"/> the transpose of <img class="formulaInl" alt="$Q$" src="form_23.png"/>.</p>
<h1><a class="anchor" id="sec_Analyzis"></a>
General Analysis</h1>
<h2><a class="anchor" id="file_sec"></a>
Management Outputs and Files</h2>
<p>Since the data recorded from every simulation can reach an enormous number{For Example, simulating a single bacterium (Celani Vergassona inverse Gaussian distribution Approach) for 1000 sec. with time step of 0.01 sec. produces the following average of data:</p>
<ul>
<li>Positions and sign gradient: 300000 doubles</li>
<li>Ligand concentration: 100000 doubles</li>
<li>Direction: 100000 doubles</li>
<li>Jumps: 1250 runs times and 1250 tumbles times.</li>
<li>Internal Dynamic 100000 doubles.</li>
</ul>
<p>the data are saved in .dat files, whose name are univocal determined for every run of the program and are made up of 3 different parts, Prefix-MittlePart-Suffix, i.e.</p>
<ul>
<li>Prefix: <code>sim%03d-</code>, where in %03d is stored the number of the simulation in the current subsection</li>
<li>MittlePart: <code>type_name</code>, according to which kind of data it contains, for example <code>Ecoli_info</code>, <code>run_t</code>, <code>theta</code> etc.</li>
<li>Suffix <code>%d-%d</code> made of two numbers, the first one the Type of Simulation, the second the Type of Model.</li>
</ul>
<p>The same structure is use for the name of the files of the images and video produces via <code>gnuplot</code></p>
<p>At the end of every simulation the following files are created in a folder (default in the folder where the executible is run, but you can change it in the setting menu), whose name is as follows:<br />
</p>
<ul>
<li>E_coli-Day-Month-Year-hour-minute-seconds-PM/AM</li>
</ul>
<p>and for DEMO version:<br />
</p>
<ul>
<li>DEMO_E_coli-Day-Month-Year-hour-minute-seconds-PM/AM</li>
</ul>
<p>Single bacterium based simulation:</p>
<ul>
<li>Video with the evolution single trajectory, Ligand concentration</li>
<li>Picture for the analysis of runs and tumbles</li>
<li>Evolution internal Dynamic</li>
<li>Overview Trajectory, Ligand concentration</li>
</ul>
<p>Large population based simulation:</p>
<ul>
<li>Video with the evolution of Density and the Ligand concentration</li>
<li>Analysis Runs and Tumbles</li>
<li>Analysis trajectory and speed barycentre</li>
</ul>
<p>All the data and the scripts (to save and to visualize) used to generate the pictures are saved in a subfolder odf the folder of the summary colled DATA.</p>
<h2><a class="anchor" id="file_sec"></a>
Management Outputs and Files</h2>
<p>In this section we present the basic analysis (that is as well a Statisical analysis) that the program provide.</p>
<ul>
<li>We estimate the density function <img class="formulaInl" alt="$p(t,x)dx$" src="form_35.png"/> via binning in a histogram, i.e.<br />
 let divide the area of the experiment into a grid: we call the rectangle in position <img class="formulaInl" alt="$i$" src="form_21.png"/> along the <img class="formulaInl" alt="$x$" src="form_25.png"/>-axis and <img class="formulaInl" alt="$j$" src="form_36.png"/> along the <img class="formulaInl" alt="$y$" src="form_27.png"/>-axis <img class="formulaInl" alt="$\Delta x_{i,j}$" src="form_37.png"/>. We denote with <img class="formulaInl" alt="$N$" src="form_38.png"/> the number of particles in the simulation and with $x_{k}(t)$ the position of the particle <img class="formulaInl" alt="$k$" src="form_39.png"/> at time <img class="formulaInl" alt="$t$" src="form_40.png"/>, we compute the histogram of the density function as follows <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathcal{H}(t,x):=\sum_{i,j}\sum_{k=1}^{N} \mathbf{1}_{\{x_{k}(t)\in \Delta x_{i,j}\}}\cdot \mathbf{1}_{\{x\in \Delta x_{i,j}\}}; \]" src="form_41.png"/>
</p>
 We do not use more sophisticated estimation since we perform no comparison with continuous model. In case such a comparison should be performed, we should employ the kernel density estimation technique with more appropriate kernel functions.</li>
<li>We perform the analysis of the barycenter of the population, i.e. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathcal{B}(t):=\frac{1}{N}\sum_{k=1}^{N}x_{k}(t); \]" src="form_42.png"/>
</p>
 its speed in direction <img class="formulaInl" alt="$\vec{e_{j}}$" src="form_43.png"/>, i.e. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathcal{V}_{j}(t):=\frac{1}{N}\sum_{k=1}^{N}\frac{\langle x_{k}(t+\delta t) - x_{k}(t), \vec{e}_{j} \rangle}{\delta t}; \]" src="form_44.png"/>
</p>
 as well as the calculation of the mean square displacement <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \langle r^2(\tau)\rangle=\lim\limits_{N\rightarrow\infty}\frac{1}{N}\cdot\sum\limits_{n=1}^N\left({x}_n(\tau)-{x}_n(0)\right)^2, \]" src="form_45.png"/>
</p>
 and the simple linear regression. In the present case it is appropriate to force the regression line to pass through the origin, i.e <img class="formulaInl" alt="$\langle r^2(\tau)\rangle = \beta\cdot t$" src="form_46.png"/>.</li>
</ul>
<h2><a class="anchor" id="sec_Stat"></a>
Fit parameters of the models</h2>
<p>The program performs the identification of the parameters of the model starting from the data. The program allows to analyze data with the following format:</p>
<p>The data recoded are: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ t_j\quad c_{\tau^r}\quad c_{\tau^t}\quad \tau^r\quad \tau^t \]" src="form_47.png"/>
</p>
<p>where <img class="formulaInl" alt="$t_j$" src="form_48.png"/> is the time of the beginning of the <img class="formulaInl" alt="$j$" src="form_36.png"/>-th run, <img class="formulaInl" alt="$c_{\tau^r}$" src="form_49.png"/> is the concentration recorded at time of the end of the run <img class="formulaInl" alt="$j$" src="form_36.png"/>, <img class="formulaInl" alt="$c_{\tau^t}$" src="form_50.png"/> the beginning end of the tumble <img class="formulaInl" alt="$j$" src="form_36.png"/> and <img class="formulaInl" alt="$\tau^r$" src="form_51.png"/> are (resp. <img class="formulaInl" alt="$\tau^t$" src="form_52.png"/>) the duration of the run (resp. tumble) <img class="formulaInl" alt="$j$" src="form_36.png"/>-th.</p>
<p>Once the program identifies which kind of data are to be analyzed, it proceed trying to find which is the best model fitting the data.</p>
<ul>
<li>[step 0] Construct a vector of classes <b><a class="el" href="class_q__tau__stat.html" title="This class save the statistics of the simulations. ">Q_tau_stat</a></b> whose dimension depends on the maximm vale of the index <img class="formulaInl" alt="$Q$" src="form_23.png"/> and the discretization of the interval <img class="formulaInl" alt="$[\min Q:dQ:\max Q]$" src="form_53.png"/> with step size <img class="formulaInl" alt="$dQ$" src="form_54.png"/>. Each class summarized the statistical moments and data from the data set.</li>
<li>[step 1] it reads through the file all the entries,</li>
<li>[step 2] calculate the <img class="formulaInl" alt="$Q$" src="form_23.png"/>-index from <b>CM10</b> and all the corresponding statistics.</li>
<li>[step 3] Plot the calculated data.</li>
<li>[step 4] Calculate the empirical rate-function using a piecewise linear model in <img class="formulaInl" alt="$Q$" src="form_23.png"/></li>
<li>[step 5] Calculate the weighted-mean square approximation (one for positive <img class="formulaInl" alt="$Q$" src="form_23.png"/>, and one for negative value of <img class="formulaInl" alt="$Q$" src="form_23.png"/>)</li>
<li>[step 6] Produced a Kolmogorov-Smirnov test using the idea in <b>BrownIG</b> for the goodness of fit of point process</li>
<li>[step 7] Iterate the steps [0] - [6] adapting the discretization of the variable <img class="formulaInl" alt="$Q$" src="form_23.png"/> and the maximum and minimum value that it can assume.</li>
</ul>
<h1><a class="anchor" id="add_new"></a>
Note to Add new Models</h1>
<p>If you want to add new model you have to modified also the following function</p>
<ul>
<li><a class="el" href="_implementatiuon___statistical___analysis_8cpp.html#a8f8a8c4455221a7187210b19e79db2be">Statistical_Analysis(string name_file_dati, string name_info_file, vector&lt;int&gt; which_compare, int n_compare, int &amp;cont_gen_sim, string &amp;versione_Matlab, int n_c)</a></li>
<li><a class="el" href="_m_o_d_e__statistical_analysis_8cpp.html#ae90fa06e1a900af1c3ce7f25a23dbfad">Set_Stocasticita(vector&lt;int&gt; &amp;which_compare ,int statisticita)</a></li>
<li><a class="el" href="_m_o_d_e___simulation_8cpp.html#ac8a4b06caf065bf49f35a040debf60dd">create_bacteria_vector(vector&lt;E_coli*&gt; &amp;batteri)</a></li>
<li>initialization_interacting_population(int tipo_simulazione, vector&lt;E_coli* &gt; *batteri_int, int n_c)</li>
</ul>
<p>It is recommended that you implement the following virtual function when subclassing <a class="el" href="class_e__coli.html" title="Base Class for a bacterium: It implements the virtual function to evolve the dynamic of the bacterium...">E_coli</a>:</p>
<p>Functions that are likely to be reimplemented</p>
<ul>
<li><a class="el" href="class_e__coli.html#a7365ef393ffeef41106ab3196a20529b">E_coli::change_par()</a> implement the way you interact with the parameters of your model</li>
<li>virtual void <a class="el" href="class_e__coli.html#a9164f6850e80cbd2e8a17faf578e376b">E_coli::reset_par()</a>; This is a helper function, to be sure you reset the parameters. You can implement it in the constructor of the new class</li>
<li>virtual void <a class="el" href="class_e__coli.html#a9535083bcaabda890d9d7e1bdf9bbaf2">E_coli::stationary_dyn(double dt, std::vector&lt;double&gt; &amp;m0, int changed_pos)</a>; implement the stationary distribution</li>
<li>virtual int <a class="el" href="class_e__coli.html#afd02577729a810d07accfded1ec79c07">E_coli::agg_dyn(double dt, double t)</a>; implement the condition that make you pass from tumble to run and vice versa</li>
<li>virtual void <a class="el" href="class_e__coli.html#a1e0e0e6a385825faf89e9cf977112d18">E_coli::agg_dyint(double dt, double t)</a>; implement you're internal dynamic model</li>
<li>virtual void <a class="el" href="class_e__coli.html#a188443c0b5f2ec1d4d534eec876fc61e">E_coli::save_dyn(ofstream &amp;file, double t)</a>; save which internal variable you want to analyse</li>
<li>virtual void <a class="el" href="class_e__coli.html#abc5c902604a8fd3825e7a81bc2d66c33">E_coli::print_info(std::ofstream &amp;file_save)</a>; call the base function and add what is new</li>
<li>virtual void E_coli::gnuplot_response(string names_info_mod, int save_, int con_gen_sim); you can you one of the two implementation for Exp or IG distribution</li>
</ul>
<p>Functions that are already implemented somewhere for most of the porposes</p>
<ul>
<li>virtual double <a class="el" href="class_e__coli.html#a115bda2f3af9612a41a68dbe74451046">E_coli::reset_barrier()</a>; you can you one of the two implementation for Exp or IG distribution</li>
<li>virtual double <a class="el" href="class_e__coli.html#a0248ab5aa9d6c7359a9d6d29324825b6">E_coli::reset_barrier_t()</a>; you can you one of the two implementation for Exp or IG distribution</li>
<li>virtual void E_coli::s_F_lambda_r(vector&lt;Q_tau_stat&gt; vector_lambda, int n_vect); you can you one of the two implementation for Exp or IG distribution</li>
<li>virtual void <a class="el" href="class_e__coli.html#a4fa268c46c23205d1390c3839bfde5c7">E_coli::gnuplot_single</a> add the features you want to display, such as the internal variable dynamics</li>
</ul>
<p>Function that till now have been used only in the base form</p>
<ul>
<li>virtual void <a class="el" href="class_e__coli.html#a91e0f221d70843886a9f0674f66478d4">E_coli::produce(Funz_C* f_i, double dt)</a>; This function is virtual, but all model use the basic function</li>
<li>virtual void <a class="el" href="class_e__coli.html#aefe8edb8f166d7e646428f5ba392e53a">E_coli::gnuplot_single_film</a> This function is virtual, but all model use the basic function</li>
<li>virtual void E_coli::gnuplotFunzInternalDynalmic(string buffer, int save_,  int con_gen_sim); it is not yet implemented</li>
</ul>
<h1><a class="anchor" id="biblio"></a>
Bibliography</h1>
<ul>
<li>When it is said Vergassola Celani Model, sometime as [SM10] is intended</li>
<li>Celani, Antonio, and Massimo Vergassola. "Bacterial strategies for chemotaxis response." Proceedings of the National Academy of Sciences 107.4 (2010): 1391-1396.</li>
<li>When it is said Vergassola Shimitzu Celani sometimes as [CSV11] is intended</li>
<li>Celani, A., T. S. Shimizu, and M. Vergassola. "Molecular and functional aspects of bacterial chemotaxis." Journal of Statistical Physics 144.2 (2011): 219-240.</li>
<li>Othmer Model means the cartoon model in one of the following:</li>
<li>Erban, Radek, and Hans G. Othmer. "From signal transduction to spatial pattern formation in E. coli: a paradigm for multiscale modeling in biology." Multiscale Modeling &amp; Simulation 3.2 (2005): 362-394.</li>
<li>Xue, Chuan, and Hans G. Othmer. "Multiscale models of taxis-driven patterning in bacterial populations." SIAM journal on applied mathematics 70.1 (2009): 133-167.</li>
<li>Similar publications </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
